<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/Favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/Favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yashuangyi.github.io","root":"/","scheme":"Gemini","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="操作系统学习笔记作者：亚双义、一真 邮箱：chenzhiyuan1999@gmail.com 时间：2020-3-27  计算机系统概述 计算机硬件组成：处理器、内存、输入输出设备、系统总线； 计算机的五大组成部件是控制器、运算器、存储器、输入设备、输出设备  计算机部件内部结构  PC——程序计数器 IR——指令寄存器 MAR——存储器地址寄存器：确定下次读写的内存单元地址 MBR——存储器缓冲">
<meta property="og:type" content="article">
<meta property="og:title" content="操作系统学习笔记">
<meta property="og:url" content="https://yashuangyi.github.io/2020/03/28/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="亚双义一真の博客">
<meta property="og:description" content="操作系统学习笔记作者：亚双义、一真 邮箱：chenzhiyuan1999@gmail.com 时间：2020-3-27  计算机系统概述 计算机硬件组成：处理器、内存、输入输出设备、系统总线； 计算机的五大组成部件是控制器、运算器、存储器、输入设备、输出设备  计算机部件内部结构  PC——程序计数器 IR——指令寄存器 MAR——存储器地址寄存器：确定下次读写的内存单元地址 MBR——存储器缓冲">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-03-27T17:40:00.000Z">
<meta property="article:modified_time" content="2020-04-16T10:34:00.562Z">
<meta property="article:author" content="yashuangyi">
<meta property="article:tag" content="OS">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://yashuangyi.github.io/2020/03/28/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>操作系统学习笔记 | 亚双义一真の博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">亚双义一真の博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">码农的奋斗记录史</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">14</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">4</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">17</span></a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/yashuangyi" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yashuangyi.github.io/2020/03/28/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/author.jpg">
      <meta itemprop="name" content="yashuangyi">
      <meta itemprop="description" content="Be RESTful">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="亚双义一真の博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          操作系统学习笔记
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-03-28 01:40:00" itemprop="dateCreated datePublished" datetime="2020-03-28T01:40:00+08:00">2020-03-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-16 18:34:00" itemprop="dateModified" datetime="2020-04-16T18:34:00+08:00">2020-04-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AC%94%E8%AE%B0%E6%9D%82%E7%83%A9/" itemprop="url" rel="index"><span itemprop="name">笔记杂烩</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="操作系统学习笔记"><a href="#操作系统学习笔记" class="headerlink" title="操作系统学习笔记"></a>操作系统学习笔记</h2><p>作者：亚双义、一真</p>
<p>邮箱：<a href="mailto:chenzhiyuan1999@gmail.com">chenzhiyuan1999@gmail.com</a></p>
<p>时间：2020-3-27</p>
<hr>
<h3 id="计算机系统概述"><a href="#计算机系统概述" class="headerlink" title="计算机系统概述"></a>计算机系统概述</h3><ol>
<li><p>计算机硬件组成：处理器、内存、输入输出设备、系统总线；</p>
<p>计算机的五大组成部件是控制器、运算器、存储器、输入设备、输出设备</p>
</li>
<li><p>计算机部件内部结构</p>
<ul>
<li>PC——程序计数器</li>
<li>IR——指令寄存器</li>
<li>MAR——存储器地址寄存器：确定下次读写的内存单元地址</li>
<li>MBR——存储器缓冲寄存器：存放要写入内存或从内存读取的数据</li>
<li>I/O AR——输入输出地址寄存器：确定某个I/O设备</li>
<li>I/O BR——输入输出缓冲寄存器：CPU与I/O设备间输入输出的数据</li>
</ul>
</li>
<li><p>指令的执行</p>
<ul>
<li>基本指令周期：取指，执行</li>
<li>四类指令：<ol>
<li>处理器-存储器：在寄存器和内存单元间传送数据</li>
<li>处理器-I/O：处理器和I/O设备间传送数据</li>
<li>数据处理：算术/逻辑运算</li>
<li>控制转移：设置PC值，改变执行顺序</li>
</ol>
</li>
</ul>
</li>
<li><p>中断</p>
<ul>
<li>概念：由于发生某些事件，暂停当前程序在CPU上的运行，转而执行响应事件的中断处理程序。待处理完成后，再返回断点继续执行或调度其它程序执行</li>
<li>分类<ol>
<li>程序中断</li>
<li>时钟中断</li>
<li>I/O中断</li>
<li>硬件失效中断</li>
</ol>
</li>
<li>中断提高CPU利用率<ol>
<li>无中断时，CPU和I/O设备串行工作</li>
<li>有中断时，CPU和I/O设备并行工作</li>
</ol>
</li>
<li>中断和指令周期：CPU在执行完一条指令之后、执行下一条指令之前，检测并处理中断</li>
<li>中断处理——硬件连接：CPU和中断控制器之间用总线上的中断请求线连接。设备发出中断后，CPU响应中断</li>
<li>中断处理——软件实现：每个中断有一个中断向量号（中断处理程序的内存入口地址），是该中断在中断向量表中的编号</li>
<li>多个中断——两个处理方法<ol>
<li>顺序处理：当处理一个中断时，禁止中断。多个中断被顺序处理</li>
<li>中断嵌套：允许高优先级的中断请求打断低级中断的处理</li>
</ol>
</li>
</ul>
</li>
<li><p>存储器</p>
<ul>
<li>平均存取时间：<code>（访问一次Cache时间+访问一次内存时间）*（1-Cache命中率）+访问一次Cache时间*Cache命中率</code></li>
<li>两级存储器（Cache-内存）有效的原因：程序的局部性原理<ol>
<li>时间局部性：在一段小的时间间隔内，被访问过的某指令或数据，可能很快会被再次访问</li>
<li>空间局部性：在一段小的时间间隔内，程序访问的地址空间往往集中在某个区域（簇）</li>
</ol>
</li>
<li>直接内存存取DMA：在DMA控制器的控制下，通过窃取总线周期，在内存和设备间（不经过CPU）传送整块数据</li>
</ul>
</li>
</ol>
<hr>
<h3 id="操作系统概述"><a href="#操作系统概述" class="headerlink" title="操作系统概述"></a>操作系统概述</h3><ol>
<li>操作系统：控制用户程序执行，充当用户程序和计算机硬件之间的接口</li>
<li>特征：并行性、共享性、虚拟性和不确定性</li>
<li>OS主要功能：进程管理、内存管理、文件管理、设备管理</li>
<li>OS目标<ul>
<li>方便：使计算机易于使用，界面友好</li>
<li>有效：提高计算机系统的资源利用率</li>
<li>扩展能力：可扩展、兼容、移植新的功能</li>
</ul>
</li>
<li>OS主要性能指标：吞吐率、资源利用率</li>
<li>分时OS：把CPU时间分割成时间片，每个用户依次轮流使用时间片（满足用户交互和及时响应的要求），强交互性但响应不太及时，能同时执行多个程序（关键问题：及时接收，及时处理）</li>
<li>批处理OS：提高资源利用率、大吞吐率和作业流程的自动化，能同时执行多个程序</li>
<li>实时OS：时间响应很及时但仅有简单地交互能力，能同时执行多个程序</li>
</ol>
<hr>
<h3 id="进程描述和控制"><a href="#进程描述和控制" class="headerlink" title="进程描述和控制"></a>进程描述和控制</h3><ol>
<li>进程：程序在一个数据集上的一次执行过程</li>
<li>进程与程序的联系与区别<ul>
<li>程序是静态的；进程是动态的，且一个进程运行时可以创建其它进程</li>
<li>一个程序可对应一个进程，也可对应多个进程</li>
</ul>
</li>
<li>进程的组成：程序代码、数据集和栈、进程控制块PCB（是进程存在的唯一标识）</li>
<li>上下文：进程运行时CPU的寄存器数据集合（现场）</li>
<li>分派器调度时发生上下文切换：保存旧进程上下文到它的PCB，从新进程的PCB恢复它的上下文到寄存器</li>
<li>进程提高了资源利用率和吞吐率，但增加了系统的时间和空间开销</li>
<li>进程的创建和终止<ul>
<li>创建：OS为该进程建立PCB，分配内存空间</li>
<li>终止：回收内存，释放资源，销毁PCB</li>
</ul>
</li>
<li>进程的五种状态<ul>
<li>新建：分配内存后将被设为就绪态</li>
<li>就绪：进程已得到除CPU外的其它所需资源</li>
<li>运行：进程的指令正被执行</li>
<li>阻塞：进程正等待资源或某事件发生</li>
<li>退出：进程正常或异常结束。回收资源，善后</li>
<li>五状态模型：处于同一状态的进程PCB组成一个进程队列</li>
</ul>
</li>
<li>进程控制块PCB：进程属性的集合<ul>
<li>OS进程表中包含所有进程的PCB</li>
<li>PCB的索引（PID）唯一地标识该进程</li>
</ul>
</li>
<li>CPU执行模式<ul>
<li>用户态：只能执行非特权指令</li>
<li>系统态（内核态）：可以执行所有指令，使用所有资源以及改变CPU状态</li>
<li>何时CPU从用户态到系统态？<ol>
<li>执行系统调用（即内核代码）时</li>
<li>发生中断或异常时，执行中断处理程序</li>
</ol>
</li>
</ul>
</li>
</ol>
<hr>
<h3 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h3><ol>
<li>进程与线程<ul>
<li>进程：分配资源的单位，不频繁地进行切换</li>
<li>线程：被调度执行的单位，虽然不拥有系统资源，但线程也拥有一定的资源，比如线程栈等，可频繁调度切换，轻装运行</li>
<li>进程的两个特性：分配资源，被调度执行</li>
</ul>
</li>
<li>线程<code>!=</code>子进程：多个线程共享进程空间，通信快；子进程空间各自独立，慢</li>
<li>多线程的优点<ul>
<li>创建/终止一个线程比创建/终止进程的时间少</li>
<li>上下文切换开销小</li>
<li>资源共享：进程的资源供其所有线程共享；线程间共享内存，通信方便</li>
<li>并发程度高，可利用多处理器结构</li>
</ul>
</li>
<li>线程的三种状态<ul>
<li>运行态</li>
<li>就绪态</li>
<li>阻塞态</li>
</ul>
</li>
<li>线程分为两类：用户级线程ULT（由用户空间中的线程库完成，OS内核不知道其存在；若发生阻塞则会阻塞所属进程；不能利用多CPU结构；内核为进程分配CPU，进程调度其某个ULT运行），内核级线程KLT（可利用多CPU结构；调度时要切换到系统态，开销大；类似进程）</li>
</ol>
<hr>
<h3 id="并发性：互斥和同步"><a href="#并发性：互斥和同步" class="headerlink" title="并发性：互斥和同步"></a>并发性：互斥和同步</h3><ol>
<li><p>概念</p>
<ul>
<li>并行：多个事件在同一时刻发生</li>
<li>并发：多个事件在同一时间间隔发生</li>
<li>原子操作：一个函数或动作序列不可分割，要么作为一个整体执行（不可中断），要么都不执行</li>
<li>临界资源：一次仅允许一个进程独占使用的不可剥夺资源</li>
<li>互斥：当一个进程正在临界区中访问临界资源时，其它进程不能进入临界区</li>
<li>同步：合作的并发进程需要按先后次序执行</li>
<li>死锁：多个进程全部阻塞，形成等待资源的循环链</li>
<li>饥饿：一个进程长期得不到资源</li>
</ul>
</li>
<li><p>考虑互斥和同步的原因：由于多个进程并发甚至并行执行，对资源的共享和竞争，使得并发进程之间相互制约</p>
</li>
<li><p>互斥的要求</p>
<ul>
<li>强制互斥</li>
<li>有限等待</li>
<li>有空让进</li>
<li>让权等待</li>
</ul>
</li>
<li><p>信号量</p>
<ul>
<li><p>概念：不要求忙等的同步互斥工具</p>
</li>
<li><p>一个信号量表示一种资源</p>
</li>
<li><p>当资源不可用时，进程将阻塞，直到另一进程释放资源时才被唤醒</p>
</li>
<li><p>信号量s只能被下面两个原语访问</p>
<ol>
<li><code>semWait(s)</code>：本进程请求分配一个资源，多个该原语次序不能颠倒</li>
<li><code>semSignal(s)</code>：本进程释放一个资源，多个该原语次序可任意</li>
<li>上述操作必须成对出现</li>
</ol>
</li>
<li><p>为每种资源设置一个信号量s，可用于n个进程的同步互斥；信号量的值表示可用资源个数</p>
</li>
<li><p>用于互斥时，s初值为1，取值为<code>1~-(n-1)</code></p>
<ol>
<li>s=1时：有1个临界资源可用，一个进程可进入临界区</li>
<li>s=0时：临界资源已分配，一个进程已进入临界区</li>
<li>s&lt;0时：临界区已被占用，|s|个阻塞进程正等待进入</li>
</ol>
</li>
<li><p>用于同步时，s初值将&gt;=0</p>
<ol>
<li>s&gt;=0时：可用资源个数</li>
<li>s&lt;0时：该资源的等待队列长度</li>
</ol>
</li>
<li><p>代码定义</p>
<ol>
<li><p>信号量的定义</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">semaphore</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> count;       <span class="comment">//信号量的值，即可用资源个数</span></span><br><span class="line">	queueType <span class="built_in">queue</span>; <span class="comment">//因该信号量而阻塞的进程队列</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>申请分配资源s</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">semWait(semaphore s)</span><br><span class="line">&#123;</span><br><span class="line">	s.count--;</span><br><span class="line">	<span class="keyword">if</span>(s.count&lt;<span class="number">0</span>)&#123;</span><br><span class="line">		将当前进程放入s.<span class="built_in">queue</span>;</span><br><span class="line">		阻塞当前进程;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>释放资源s</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">semSignal(semaphore s)</span><br><span class="line">&#123;</span><br><span class="line">	s.count++;</span><br><span class="line">	<span class="keyword">if</span>(s.count&lt;=<span class="number">0</span>)&#123;</span><br><span class="line">		从s.<span class="built_in">queue</span>中移除进程P;</span><br><span class="line">		将进程P插入到就绪队列;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p>实现互斥：每个进程在进入临界区前，执行<code>semWait(s)</code>;退出临界区后，执行<code>semSignal(s)</code></p>
</li>
</ul>
</li>
<li><p>生产者/消费者问题</p>
<ul>
<li>一组生产者进程产生数据，放到缓冲区</li>
<li>一组消费者进程从缓冲区中取出数据使用<ol>
<li>有限缓冲：假设缓冲池大小固定，包含k个缓冲区。生产者和消费者共用一个循环缓冲池</li>
<li>无限缓冲：缓冲区数量无限制</li>
</ol>
</li>
<li>有限缓冲的设置<ol>
<li>缓冲池一次只能让一个进程访问（互斥）：设一信号量s，初值为1</li>
<li>生产者需要空缓冲来发送数据（同步）：设一信号量empty，初值为sizeofbuffer</li>
<li>消费者需要满缓冲来获取数据（同步）：设一信号量full，初值为0</li>
</ol>
</li>
</ul>
</li>
<li><p>管程</p>
<p>管程将共享对象以及能对它进行的所有操作集中在一个模块中，管程本身结构保证各操作的互斥执行</p>
</li>
</ol>
<hr>
<h3 id="并发：死锁和饥饿"><a href="#并发：死锁和饥饿" class="headerlink" title="并发：死锁和饥饿"></a>并发：死锁和饥饿</h3><ol>
<li>原理：当一组进程中的每个进程都在等待某个事件，而只有在这组进程中的其它阻塞进程才能触发该事件，则这组进程发生死锁</li>
<li>原因：进程推进顺序不当、竞争资源</li>
<li>若死锁，则资源分配图中必有环路</li>
<li>死锁的四个必要条件（必须同时成立）<ul>
<li>互斥</li>
<li>占有且等待</li>
<li>不可抢占</li>
<li>循环等待</li>
</ul>
</li>
<li>死锁的三种处理方法<ul>
<li>死锁预防：破坏四个必要条件之一</li>
<li>死锁避免：不破坏必要条件，允许进程动态申请资源，但检查资源分配状态，以避免可能导致的死锁</li>
<li>死锁检测和恢复：检查系统是否已死锁、哪些进程和资源涉及死锁，并撤销死锁进程</li>
<li>忽略死锁：假设死锁不会发生</li>
</ul>
</li>
<li>进程启动拒绝<ul>
<li>资源总量R：<code>R[j]=k</code>表示系统中第j类资源有k个</li>
<li>可用资源V：<code>V[j]=k</code>表示未被分配的第j类资源现有k个</li>
<li>最大需求矩阵C：<code>C[i,j]=k</code>表示进程i需要第j类资源最多为k个</li>
<li>已分配矩阵A：<code>A[i,j]=k</code>表示进程i已分得第j类资源k个</li>
</ul>
</li>
</ol>
<hr>
<h3 id="内存管理"><a href="#内存管理" class="headerlink" title="内存管理"></a>内存管理</h3><ol>
<li>内存管理术语<ul>
<li>页框（帧）：一个固定长度的内存块</li>
<li>页：一个固定长度的数据块（程序代码或数据），平时存储在二级存储器，常用尺寸：4KB</li>
<li>段：一个变长的数据块，平时存储在二级存储器</li>
</ul>
</li>
<li>重定位：进程执行过程中，需要将要访问的程序地址转换为实际的内存物理地址<ul>
<li>逻辑地址：程序中引用的地址，从0顺序编址</li>
<li>物理地址：数据在内存中的单元地址</li>
</ul>
</li>
<li>内存管理技术<ul>
<li>分区（连续分配，为一个用户程序分配一个连续的内存空间）<ol>
<li>固定分区：易产生区内内碎片，内存利用率低</li>
<li>动态分区：易产生区间外碎片<ul>
<li>可通过压缩解决外碎片</li>
<li>分配策略<ol>
<li>首次适配（First Fit）：空闲区按起始地址递增顺序排列（从链首开始查找）：低地址端遗留许多碎片，高地址端有大空闲区——最常用，内存分配最快，内存回收最佳</li>
<li>下次适配（Next Fit）：空闲区按起始地址递增顺序排列（从上次扫描结束处继续查找）：平均查找时间缩短，空间利用比FF均衡</li>
<li>最佳适配（Best Fit）：空闲区按分区大小递增顺序排列：链首部碎片多，查找费时，回收合并时复杂——查找最合适空闲区时最快，但碎片最多，压缩最频繁，性能最差</li>
<li>最差适配（Worst Fit）：空闲区按分区大小递减顺序排列：小碎片较少，但最大的空闲区也不会很大</li>
</ol>
</li>
</ul>
</li>
<li>可通过压缩解决外碎片</li>
</ol>
</li>
<li>分页<ol>
<li>内存划分为大小相等的物理块（页框，帧）</li>
<li>帧大小L，通常为4KB</li>
<li><code>页号=int（地址/帧大小）</code>，<code>页内偏移=地址mod帧大小</code>。例如：32bit的逻辑地址A可表示为：页号p（20b），页内偏移d(12b)</li>
<li>页表：记录进程中的每个页存放在哪一个内存帧，位于内存；每个进程都有一个页表</li>
<li><code>物理地址=帧号*帧长+页内偏移量</code></li>
</ol>
</li>
<li>分段<ol>
<li>32bit逻辑地址：&lt;段号s，段内偏移量d&gt;</li>
<li>段表：每个进程一个段表</li>
<li><code>物理地址=段起址+段内偏移量</code></li>
</ol>
</li>
</ul>
</li>
<li>伙伴系统<ul>
<li>Unix、Linux采用伙伴系统分配内存页框（帧）</li>
<li>伙伴：两个相邻的帧块。每块大小必须相同</li>
</ul>
</li>
</ol>
<hr>
<h3 id="虚拟内存"><a href="#虚拟内存" class="headerlink" title="虚拟内存"></a>虚拟内存</h3><ol>
<li>虚拟内存允许进程执行时只将部分程序放入内存，因此程序可以比物理内存大</li>
<li>术语<ul>
<li>虚拟内存：用辅助存储器（一般指磁盘）作为内存的补充</li>
<li>虚拟地址：即逻辑地址</li>
<li>虚拟地址空间：分配给某进程（程序）的虚拟地址范围</li>
<li>实地址：即物理地址</li>
</ul>
</li>
<li>进程对代码和数据的引用和访问有集簇倾向，所以虚拟内存方案可行</li>
<li>虚拟页式管理中的页表：<code>帧号-P驻留位-引用字段-M修改位-磁盘地址</code></li>
<li>倒排页表为内存的每一页框设置一个页表项</li>
<li>快表TLB：将页表中进程运行最常用的部分放入TLB，TLB集成在CPU内部的MMU里面<ul>
<li>若要访问的页号位于TLB，则从TLB中取出帧号</li>
<li>否则，从内存中的页表取出帧号，且添加进TLB</li>
<li>当TLB满时，淘汰旧表项，再写入新表项</li>
</ul>
</li>
<li>段页式：用户程序划分为段，段再划分为大小相等的页</li>
<li>总结——各存储管理方法<ul>
<li>固定分区：支持多道程序设计，算法简单，但内碎片多</li>
<li>动态分区：无内碎片，但用于外碎片的压缩处理时间长</li>
<li>简单页式：克服了碎片多和压缩处理时间长的缺点，但不支持虚拟内存</li>
<li>虚存页式：支持虚拟存储，离散分配内存，无外碎片，但不能以自然的方式提供内存的共享和存取保护机制</li>
<li>虚存段式：易于共享保护，内存碎片多，支持虚拟内存</li>
<li>虚存段页式：易于共享保护，内存碎片少，支持虚拟内存</li>
</ul>
</li>
<li>置换策略<ul>
<li>最佳置换算法OPT：淘汰永不再使用或下次访问距当前时间最长的页面</li>
<li>最近最少使用算法LRU：淘汰在最近一段时间内最久未使用的一页</li>
<li>FIFO算法：淘汰驻留内存时间最久的一页</li>
<li>简单时钟算法Clock</li>
</ul>
</li>
<li><code>缺页率=不成功访问次数/总访问次数</code></li>
<li>当系统并发度过高时，缺页频繁，用于调页的时间比进程实际运行的时间还多，CPU利用率急剧下降，此时发生了抖动</li>
</ol>
<hr>
<h3 id="单处理器调度"><a href="#单处理器调度" class="headerlink" title="单处理器调度"></a>单处理器调度</h3><ol>
<li>处理器调度类型<ul>
<li>长程调度：新作业提交时，决定是否将其送入内存，成为一个进程。也称作业调度</li>
<li>短程调度：决定将CPU分配给哪个就绪进程</li>
<li>中程调度：决定把哪些进程在内存与磁盘间交换</li>
</ul>
</li>
<li>选择调度策略<ul>
<li>先来先服务FCFS</li>
<li>轮转RR：各进程按提交顺序排成就绪队列，然后依次占用处理器，运行某一时间片，时间片完则排入就绪队列尾</li>
<li>最短进程优先SPN：调度CPU执行时间预期最短的进程，直至运行完或阻塞时，再重新调度</li>
<li>最短剩余时间SRT：新进程到达时，若新进程的预计运行时间比当前进程的剩余运行时间更短，则抢占当前进程</li>
<li>最高响应比优先算法：综合了FCFS和SPN算法</li>
<li>反馈（多级反馈队列）</li>
</ul>
</li>
</ol>
<hr>
<h3 id="IO管理和磁盘调度"><a href="#IO管理和磁盘调度" class="headerlink" title="IO管理和磁盘调度"></a>IO管理和磁盘调度</h3><ol>
<li>直接内存存取DMA：在内存和设备间直接进行块传送：I/O效率高</li>
<li>缓冲：缓和CPU和I/O设备间速度不匹配矛盾，提高并行性</li>
<li>磁盘调度<ul>
<li>扇区是最小寻址单位和存取单位（但不是分配单位）</li>
<li>磁盘访问时间<ol>
<li><code>寻道时间=启动磁盘时间+横跨n条磁道时间</code>：对磁盘访问时间影响最大</li>
<li><code>旋转延迟时间=将待访问扇区转到磁头下的时间</code></li>
<li><code>传输时间=读写字节数/（旋转速度*每磁道字节数）</code></li>
</ol>
</li>
<li>磁盘调度策略<ol>
<li>先进先出FIFO：按请求的接收顺序服务</li>
<li>先进后出LIFO：先处理最新提出的请求</li>
<li>最短服务时间优先算法SSTF：优先选择距当前磁头位置最近的访问请求进行服务</li>
<li>SCAN扫描算法：选择位于磁头移动方向前方且距磁头位置最近的访问请求进行服务。 当前方没有访问请求时，立即改变磁头移动方向 (LOOK)；或继续扫描到磁盘边界后再转向(SCAN)</li>
<li>C-SCAN循环扫描算法：磁头从磁盘一端移到另一端，随着移动而不断处理请求。当磁头移到另一端 时，马上返回磁盘起始，返回时不处理请求</li>
</ol>
</li>
</ul>
</li>
<li>RAID——独立磁盘冗余阵列<ul>
<li>RAID用多个小容量磁盘代替单个大容量磁盘</li>
<li>RAID 0：无冗余的并行访问</li>
<li>RAID 1：可并行访问的镜像磁盘（复制每个磁盘）</li>
<li>RAID 2：位汉明校验</li>
<li>RAID 3：位交错奇偶校验</li>
<li>RAID 4：块奇偶校验</li>
<li>RAID 5：块分布奇偶校验</li>
<li>RAID 6：P+Q双重冗余</li>
</ul>
</li>
</ol>
<hr>
<h3 id="文件管理"><a href="#文件管理" class="headerlink" title="文件管理"></a>文件管理</h3><ol>
<li>文件分配<ul>
<li>连续分配</li>
<li>链接分配</li>
<li>索引分配</li>
</ul>
</li>
</ol>

    </div>

    
    
    

		<div>
		  
			<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

		  
		</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/OS/" rel="tag"># OS</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/03/25/Docker%E5%AE%89%E8%A3%85%E5%8F%8A%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4/" rel="prev" title="Docker安装及基本命令">
      <i class="fa fa-chevron-left"></i> Docker安装及基本命令
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/03/31/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="next" title="计算机网络学习笔记">
      计算机网络学习笔记 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#操作系统学习笔记"><span class="nav-number">1.</span> <span class="nav-text">操作系统学习笔记</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#计算机系统概述"><span class="nav-number">1.1.</span> <span class="nav-text">计算机系统概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#操作系统概述"><span class="nav-number">1.2.</span> <span class="nav-text">操作系统概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#进程描述和控制"><span class="nav-number">1.3.</span> <span class="nav-text">进程描述和控制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#线程"><span class="nav-number">1.4.</span> <span class="nav-text">线程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#并发性：互斥和同步"><span class="nav-number">1.5.</span> <span class="nav-text">并发性：互斥和同步</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#并发：死锁和饥饿"><span class="nav-number">1.6.</span> <span class="nav-text">并发：死锁和饥饿</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#内存管理"><span class="nav-number">1.7.</span> <span class="nav-text">内存管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#虚拟内存"><span class="nav-number">1.8.</span> <span class="nav-text">虚拟内存</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#单处理器调度"><span class="nav-number">1.9.</span> <span class="nav-text">单处理器调度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IO管理和磁盘调度"><span class="nav-number">1.10.</span> <span class="nav-text">IO管理和磁盘调度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文件管理"><span class="nav-number">1.11.</span> <span class="nav-text">文件管理</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
	  <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=33316436&auto=0&height=66"></iframe>
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="yashuangyi"
      src="/images/author.jpg">
  <p class="site-author-name" itemprop="name">yashuangyi</p>
  <div class="site-description" itemprop="description">Be RESTful</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">17</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/yashuangyi" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yashuangyi" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">亚双义、一真</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,0' opacity='0.5' zIndex='-1' count='150' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body>
</html>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/clicklove.js"></script>

